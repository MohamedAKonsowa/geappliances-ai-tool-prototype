{
  "title": "Timesheet Performance Analyzer",
  "description": "A client‑side GE Appliances internal tool that lets users upload a CSV timesheet, computes punctuality against a 9 am‑5 pm schedule, identifies the best and worst performers, and explains the results with tables and charts. Updated to ensure reliable CSV upload via drag‑and‑drop and click‑to‑select.",
  "pages": [
    {
      "name": "Home",
      "purpose": "Upload CSV, view overall analysis, and see best/worst employee highlights."
    },
    {
      "name": "Details",
      "purpose": "Display a sortable, searchable table of employee metrics and a bar chart of total deviation."
    },
    {
      "name": "Settings",
      "purpose": "Toggle dark/light mode, clear stored data, and adjust upload preferences."
    }
  ],
  "ui_components": [
    "Drag‑and‑drop zone with clickable fallback to hidden file input",
    "Hidden <input type='file'> element restricted to .csv files",
    "Responsive header with app title, dark‑mode toggle, and reset button",
    "Card components for Best Performer and Worst Performer summaries",
    "Bar chart (Chart.js) showing total deviation per employee",
    "Sortable, searchable DataTable (Simple‑DataTables) of employee metrics",
    "Modal dialog for AI‑generated explanation of the scoring logic",
    "Toast notifications (SweetAlert2) for upload success, errors, and processing status",
    "Footer with version information"
  ],
  "libraries": [
    "Tailwind CSS for styling and responsive layout",
    "DaisyUI for ready‑made component styles",
    "Lucide icons for UI icons",
    "Chart.js for bar‑chart visualization",
    "PapaParse for client‑side CSV parsing",
    "Simple‑DataTables for interactive tables",
    "SweetAlert2 for toast and alert dialogs",
    "Alpine.js for lightweight modal handling",
    "window.geaRuntimeLLM(prompt) for optional AI‑generated explanations"
  ],
  "state": [
    "uploadedFile: File object representing the selected CSV",
    "rawRows: array of parsed CSV rows (objects with employee_id, name, date, clock_in, clock_out)",
    "employees: array of objects { employee_id, name, avgLateMins, avgEarlyMins, totalDeviation }",
    "bestEmployee: object containing the employee with the lowest totalDeviation",
    "worstEmployee: object containing the employee with the highest totalDeviation",
    "theme: 'light' | 'dark' persisted in localStorage",
    "showExplanationModal: boolean",
    "explanationText: string generated by LLM or template"
  ],
  "interactions": [
    "User clicks or drags a CSV onto the upload zone → drop area forwards the event to the hidden file input and prevents default browser handling.",
    "On file selection, validate MIME type and extension; if invalid, show a SweetAlert2 error toast.",
    "When a valid CSV is chosen, display a loading overlay, parse the file with PapaParse (header: true, skipEmptyLines: true).",
    "For each row, compute lateMins = max(0, minutes between clock_in and 09:00) and earlyMins = max(0, minutes between 17:00 and clock_out).",
    "Aggregate per employee: average late minutes, average early‑leave minutes, totalDeviation = avgLate + avgEarly.",
    "Determine bestEmployee (minimum totalDeviation) and worstEmployee (maximum totalDeviation).",
    "Store the computed employees array in localStorage (key: timesheetEmployees) so a page refresh retains the analysis.",
    "Render Best and Worst cards with name, avgLate, avgEarly, totalDeviation, and a \"Why?\" button.",
    "When \"Why?\" is clicked, call window.geaRuntimeLLM with a prompt that includes the employee’s metrics; populate explanationText and open the modal.",
    "Create a Chart.js bar chart where each bar represents totalDeviation; color the best performer bar green and the worst red.",
    "Initialize Simple‑DataTables on the employee table, enabling column sorting, pagination, and a text search box.",
    "Theme toggle button switches Tailwind’s dark class, updates the stored theme, and changes the icon accordingly.",
    "Reset button clears localStorage for both data and theme, then reloads the page to the initial state."
  ],
  "acceptance_criteria": [
    "The upload zone accepts a CSV via drag‑and‑drop or by clicking to open the file picker; the hidden file input is triggered correctly.",
    "Invalid files (non‑CSV) produce a clear error toast and do not crash the app.",
    "CSV parsing completes without errors and populates the employee metrics table.",
    "Average lateness and early‑leave are calculated in minutes with two‑decimal precision.",
    "Best Performer card shows the employee with the smallest total deviation; Worst Performer card shows the largest.",
    "Each card includes a concise natural‑language explanation generated by the LLM or a fallback template.",
    "Bar chart displays all employees; best performer bar is highlighted in green, worst in red.",
    "Table columns are sortable, searchable, and paginated; clicking a row also opens the explanation modal for that employee.",
    "Dark‑mode toggle works, persists across reloads, and updates all UI components.",
    "All computed data and theme preference are saved in localStorage; refreshing the page restores the previous analysis.",
    "No external network requests are made except for loading permitted CDN libraries; all CSV processing runs client‑side.",
    "The UI meets GE Appliances accessibility standards: keyboard‑navigable, ARIA labels on interactive elements, sufficient color contrast."
  ]
}