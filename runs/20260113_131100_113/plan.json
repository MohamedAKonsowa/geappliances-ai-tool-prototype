{
  "title": "Timesheet Performance Analyzer – Secure Vanilla Edition",
  "description": "A client‑side internal tool for GE Appliances that lets users upload a CSV timesheet, computes punctuality against a 9 am‑5 pm schedule, identifies the best and worst performers, and provides a concise explanation. The app uses only native web technologies (HTML, CSS, JavaScript) to comply with strict security policies—no external scripts, CDN assets, or network requests are loaded.",
  "pages": [
    {
      "name": "Home",
      "purpose": "Upload CSV, view best/worst performer cards, display a simple SVG bar chart of total deviation, and show an employee metrics table."
    }
  ],
  "ui_components": [
    "Drag‑and‑drop upload zone with hidden file input fallback",
    "Header with app title and dark‑mode toggle button",
    "Card for Best Performer summary",
    "Card for Worst Performer summary",
    "SVG bar chart showing total deviation per employee (green for best, red for worst)",
    "Plain HTML table for employee metrics with sortable columns (implemented in vanilla JS)",
    "Modal dialog for explanation (opened only via \"Why?\" buttons)",
    "Toast‑style notification area for success/error messages (implemented with CSS animations)",
    "Loading overlay with spinner that appears only while parsing/processing",
    "Footer with version and year"
  ],
  "libraries": [
    "None – all functionality is built with native HTML, CSS, and JavaScript"
  ],
  "state": [
    "uploadedFile: File object representing the selected CSV",
    "rawRows: array of parsed CSV rows (employee_id, name, date, clock_in, clock_out)",
    "employees: array of { employee_id, name, avgLateMins, avgEarlyMins, totalDeviation }",
    "bestEmployee: object with the lowest totalDeviation",
    "worstEmployee: object with the highest totalDeviation",
    "theme: 'light' | 'dark' persisted in localStorage",
    "showExplanationModal: boolean (default false) controlling modal visibility",
    "modalEmployee: object of the employee whose explanation is shown",
    "modalType: string ('best' | 'worst') for modal heading",
    "explanationText: string generated by LLM or fallback template",
    "loading: boolean indicating parsing/processing state (true only during file handling)",
    "sortState: { column: string, direction: 'asc' | 'desc' } for table sorting"
  ],
  "interactions": [
    "User drags a CSV onto the upload zone or clicks it to open the file picker; the hidden input receives the file.",
    "On file selection, validate the file extension; if invalid, show a CSS‑based toast error and keep loading=false.",
    "When a valid CSV is chosen, set loading=true, read the file with FileReader, split lines, parse CSV manually (comma‑separated, header row ignored), and push rows into rawRows.",
    "For each row, compute lateMins = max(0, minutes between clock_in and 09:00) and earlyMins = max(0, minutes between 17:00 and clock_out).",
    "Aggregate per employee: average late minutes, average early‑leave minutes, totalDeviation = avgLateMins + avgEarlyMins (rounded to two decimals).",
    "Identify bestEmployee (minimum totalDeviation) and worstEmployee (maximum totalDeviation).",
    "Persist employees, bestEmployee, worstEmployee, and theme in localStorage; on page load, restore them and keep loading=false.",
    "Render Best and Worst cards with metrics and a \"Why?\" button.",
    "Clicking a \"Why?\" button sets modalEmployee, modalType, calls window.geaRuntimeLLM with a prompt containing that employee’s metrics, stores the result in explanationText (fallback to a templated sentence on failure), and sets showExplanationModal=true.",
    "Modal can be closed via the X button, clicking outside, or pressing Escape; closing resets modal state.",
    "Generate an SVG bar chart: create a <svg> element, draw a rectangle for each employee proportional to totalDeviation, color the bar green for the best performer and red for the worst, label each bar with employee name and deviation value.",
    "Table column headers are clickable; clicking toggles sort direction and re‑renders the tbody according to sortState.",
    "Dark‑mode toggle switches a CSS class on <html>, updates CSS custom properties for colors, stores the preference in localStorage, and refreshes UI components.",
    "Loading overlay shows a CSS spinner while parsing; it is hidden in a finally block after processing completes or fails.",
    "A simple toast container shows transient messages (success, error) that fade out after a few seconds."
  ],
  "acceptance_criteria": [
    "Upload zone accepts CSV via drag‑and‑drop or click‑to‑browse; hidden file input is correctly triggered.",
    "Non‑CSV files produce a clear error toast and do not crash the app.",
    "When a valid CSV is selected, a spinner appears only during parsing and processing and disappears automatically after the work finishes, regardless of success or error.",
    "CSV parsing completes without errors; employee metrics table populates correctly with two‑decimal minute values.",
    "Average lateness and early‑leave are calculated in minutes with two‑decimal precision.",
    "Best Performer card shows the employee with the smallest total deviation; Worst Performer card shows the largest.",
    "Explanation modal is hidden on page load and only appears after the user clicks a \"Why?\" button.",
    "Modal displays a concise natural‑language explanation generated by the LLM or a fallback template.",
    "SVG bar chart shows a bar for each employee; the bar for the best performer is green, the bar for the worst performer is red, and all bars are correctly scaled.",
    "Employee table columns are sortable by clicking headers; sorting toggles between ascending and descending; the table remains searchable via a built‑in filter input.",
    "Dark‑mode toggle works, persists across reloads, and updates all UI components (backgrounds, text, cards, chart colors).",
    "All computed data and theme preference are saved in localStorage; refreshing the page restores the previous analysis without showing any modal or spinner.",
    "No external network requests are made; all code, styles, and assets are bundled in the page and run entirely client‑side.",
    "UI complies with GE Appliances accessibility standards: keyboard‑navigable, ARIA labels on interactive elements, sufficient color contrast, focus outlines visible."
  ]
}